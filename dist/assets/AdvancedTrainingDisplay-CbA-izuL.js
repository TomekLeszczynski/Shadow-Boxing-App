import{_ as H,a as J,b as K,c as O,e as Q,n as X,p as Y,d as Z}from"./nextCommandDelay-OHIAAJ9B.js";import{a as ee,b as te}from"./TrainingStore-MnWsloeG.js";import{C as se,D as ne,E as ae,G as oe,d as re,p as ie,b as w,h as u,q as E,i as le,s as ce,o as a,k as F,j as d,c,t as v,x as y,m as r,a as m,f as $,z as ue,A as de,B as ve}from"./index-D6n8S4V6.js";let _;const S=(i,e,l,f)=>{_=setInterval(()=>{if(e.value>0){e.value--;return}if(i.value>0&&e.value===0){i.value--,e.value=59;return}else{f&&f(),clearInterval(_),l();return}},1e3)},me=se(ne,"gs://shadow-boxing-workout.appspot.com/audio/advanced/low_complexity"),k=[],_e=async()=>{try{const i=await ae(me);for(const e of i.items)try{const l=await oe(e);k.push(l)}catch(l){console.error("Error downloading advanced combinations audio files:"+l)}}catch(i){console.error("Error listing files:"+i)}},fe={key:0,class:"text-4xl capitalize md:text-5xl","aria-label":"Training Phase"},he={key:0,class:"text-[14rem] text-center divide-y-4 w-[20rem]"},pe={class:"block pb-4"},ge={class:"pt-4"},ye={key:0},ke={key:0,class:"text-[12rem] text-custom-white"},xe={key:1,class:"text-[12rem]"},Ie=m("p",null,"Well",-1),we=m("p",null,"done!",-1),Se=[Ie,we],be={key:0},Ce={key:1},Te=3,Ee=re({__name:"AdvancedTrainingDisplay",setup(i){const e=ee(),l=ie(),f=te(),h=w(0),o=w(0),n=w(0),P=()=>{e.toggleStatus()},W=async()=>{const t=l.user;if(t&&e.status==="done")try{const s=ue(de,"users",t.uid,"trainings");await ve(s,{training:"advanced",rounds:e.rounds,complexity:e.complexity,intensity:e.intensity,date:new Date})}catch(s){console.error("Saving Advanced Training Session Error:"+s)}},B=u(()=>h.value===e.rounds),p=u(()=>e.status=="work"),M=u(()=>e.status=="paused"),b=u(()=>e.status=="done"),N=u(()=>B.value&&o.value==0&&n.value==0),C={minutes:0,seconds:0},T={minutes:3,seconds:0},x=(t,s)=>{o.value=t,n.value=s},L=()=>{x(C.minutes,C.seconds),Y(),S(o,n,A,Z)},z=()=>{e.status="work",h.value++},U=()=>{D(),x(o.value,n.value),S(o,n,A),I()},j=()=>{N.value?(e.status="done",clearInterval(_)):(x(T.minutes,T.seconds),S(o,n,z))},A=()=>{e.status="rest"},D=()=>{clearInterval(_),clearInterval(g)},q=()=>{L(),I()};E(()=>e.status,(t,s)=>{t=="work"?s=="paused"?U():q():t=="rest"||t=="done"?j():t=="paused"&&clearInterval(_)}),E(()=>f.countdownFinished,t=>{t&&(h.value=1,e.status="work")});let R,g;const G=u(()=>o.value===0&&n.value<=3),V=t=>{if(t){const s=Math.floor(Math.random()*k.length);R=t[s]}else console.error("URLs array is empty: "+Error)},I=()=>{e.status==="work"&&!G.value?(V(k),Q(R),clearInterval(g),g=setInterval(I,X(Te,e.intensity)*1e3)):clearInterval(g)};return le(async()=>{if(k.length==0)await _e();else return}),ce(()=>{D(),e.$reset()}),(t,s)=>(a(),F(H,null,{"additional-info":d(()=>[p.value?(a(),c("div",fe,v(y(e).status),1)):r("",!0)]),"main-info":d(()=>[p.value?(a(),c("div",he,[m("span",pe,"0"+v(o.value),1),m("div",ge,[n.value<10?(a(),c("span",ye,"0")):r("",!0),m("span",null,v(n.value),1)])])):r("",!0)]),"training-status-info":d(()=>[M.value?(a(),c("span",ke,"Paused")):r("",!0),b.value?(a(),c("div",xe,Se)):r("",!0)]),"session-data":d(()=>[p.value?(a(),c("span",be,"Round "+v(h.value)+" of ",1)):r("",!0),p.value?(a(),c("span",Ce,v(y(e).rounds),1)):r("",!0)]),"buttons-section":d(()=>[$(J,{"on-click-handler":P,status:y(e).status},null,8,["status"]),$(K,{status:y(e).status},null,8,["status"]),b.value?(a(),F(O,{key:0,"save-session":W})):r("",!0)]),_:1}))}});export{Ee as default};
